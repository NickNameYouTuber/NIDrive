import{k as B,l as P,s as $,m as K,g,n as V,_ as z,j as e,o as j,p as A,q as H,r as w,i as I,P as M,B as c,T as u,I as Q,h as L,c as J,f as X,b as Y,D as Z,t as ee}from"./index-83407388.js";import{G as v,d as te}from"./CloudUpload-c4ec0af7.js";import{T as se,C as re,d as R,a as oe,b as ae,c as ie,e as O,L as ne,f as ce,g as le}from"./PictureAsPdf-94ae4360.js";import{B as N}from"./Button-b33cd292.js";function de(s){return P("MuiCardActionArea",s)}const ue=B("MuiCardActionArea",["root","focusVisible","focusHighlight"]),S=ue,fe=["children","className","focusVisibleClassName"],xe=s=>{const{classes:r}=s;return H({root:["root"],focusHighlight:["focusHighlight"]},de,r)},he=$(K,{name:"MuiCardActionArea",slot:"Root",overridesResolver:(s,r)=>r.root})(({theme:s})=>({display:"block",textAlign:"inherit",borderRadius:"inherit",width:"100%",[`&:hover .${S.focusHighlight}`]:{opacity:(s.vars||s).palette.action.hoverOpacity,"@media (hover: none)":{opacity:0}},[`&.${S.focusVisible} .${S.focusHighlight}`]:{opacity:(s.vars||s).palette.action.focusOpacity}})),ge=$("span",{name:"MuiCardActionArea",slot:"FocusHighlight",overridesResolver:(s,r)=>r.focusHighlight})(({theme:s})=>({overflow:"hidden",pointerEvents:"none",position:"absolute",top:0,right:0,bottom:0,left:0,borderRadius:"inherit",opacity:0,backgroundColor:"currentcolor",transition:s.transitions.create("opacity",{duration:s.transitions.duration.short})})),pe=g.forwardRef(function(r,i){const a=V({props:r,name:"MuiCardActionArea"}),{children:l,className:p,focusVisibleClassName:d}=a,f=z(a,fe),x=a,t=xe(x);return e.jsxs(he,j({className:A(t.root,p),focusVisibleClassName:A(d,t.focusVisible),ref:i,ownerState:x},f,{children:[l,e.jsx(ge,{className:t.focusHighlight,ownerState:x})]}))}),me=pe;function ve(s){return P("MuiCardMedia",s)}B("MuiCardMedia",["root","media","img"]);const je=["children","className","component","image","src","style"],ye=s=>{const{classes:r,isMediaComponent:i,isImageComponent:a}=s;return H({root:["root",i&&"media",a&&"img"]},ve,r)},Ce=$("div",{name:"MuiCardMedia",slot:"Root",overridesResolver:(s,r)=>{const{ownerState:i}=s,{isMediaComponent:a,isImageComponent:l}=i;return[r.root,a&&r.media,l&&r.img]}})(({ownerState:s})=>j({display:"block",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},s.isMediaComponent&&{width:"100%"},s.isImageComponent&&{objectFit:"cover"})),be=["video","audio","picture","iframe","img"],_e=["picture","img"],Se=g.forwardRef(function(r,i){const a=V({props:r,name:"MuiCardMedia"}),{children:l,className:p,component:d="div",image:f,src:x,style:t}=a,m=z(a,je),n=be.indexOf(d)!==-1,y=!n&&f?j({backgroundImage:`url("${f}")`},t):t,C=j({},a,{component:d,isMediaComponent:n,isImageComponent:_e.indexOf(d)!==-1}),b=ye(C);return e.jsx(Ce,j({className:A(b.root,p),as:d,role:!n&&f?"img":void 0,ref:i,style:y,ownerState:C,src:n?f||x:void 0},m,{children:l}))}),Ae=Se;var F={},Me=I;Object.defineProperty(F,"__esModule",{value:!0});var E=F.default=void 0,Re=Me(w()),$e=e;E=F.default=(0,Re.default)((0,$e.jsx)("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm2 11h-3v3.75c0 1.24-1.01 2.25-2.25 2.25S8.5 17.99 8.5 16.75s1.01-2.25 2.25-2.25c.46 0 .89.14 1.25.38V11h4zm-3-4V3.5L18.5 9z"}),"AudioFile");var k={},we=I;Object.defineProperty(k,"__esModule",{value:!0});var T=k.default=void 0,Ie=we(w()),Fe=e;T=k.default=(0,Ie.default)((0,Fe.jsx)("path",{d:"M14 2H6.01c-1.1 0-2 .89-2 2L4 20c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8zm-1 7V3.5L18.5 9zm1 5 2-1.06v4.12L14 16v1c0 .55-.45 1-1 1H9c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h4c.55 0 1 .45 1 1z"}),"VideoFile");var D={},ke=I;Object.defineProperty(D,"__esModule",{value:!0});var U=D.default=void 0,De=ke(w()),Ne=e;U=D.default=(0,De.default)((0,Ne.jsx)("path",{d:"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z"}),"KeyboardArrowRight");const Be=({recentFiles:s,recentFolders:r,onFileClick:i,onFolderClick:a,onViewAllClick:l,isLoading:p=!1})=>{const d=[...s.map(t=>({...t,type:"file",date:new Date(t.created_at)})),...r.map(t=>({...t,type:"folder",date:new Date(t.created_at)}))].sort((t,m)=>m.date.getTime()-t.date.getTime()).slice(0,6),f=t=>t.startsWith("image/")?e.jsx(ae,{fontSize:"large",color:"primary"}):t==="application/pdf"?e.jsx(ie,{fontSize:"large",color:"error"}):t.startsWith("video/")?e.jsx(T,{fontSize:"large",color:"secondary"}):t.startsWith("audio/")?e.jsx(E,{fontSize:"large",color:"success"}):e.jsx(O,{fontSize:"large",color:"action"}),x=t=>new Date(t).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"});return e.jsxs(M,{sx:{p:3,mb:4,borderRadius:2},elevation:1,children:[e.jsxs(c,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(u,{variant:"h6",component:"h2",children:"Недавние элементы"}),e.jsx(se,{title:"Показать все",children:e.jsx(Q,{onClick:l,size:"small",children:e.jsx(U,{})})})]}),p?e.jsx(c,{sx:{display:"flex",justifyContent:"center",py:4},children:e.jsx(L,{})}):d.length===0?e.jsx(c,{sx:{py:3},children:e.jsx(u,{variant:"body1",color:"textSecondary",sx:{textAlign:"center"},children:"No recent items found"})}):e.jsx(v,{container:!0,spacing:2,children:d.map(t=>e.jsx(v,{item:!0,xs:12,sm:6,md:4,lg:2,children:e.jsx(re,{sx:{height:"100%",display:"flex",flexDirection:"column","&:hover":{boxShadow:3}},onClick:()=>t.type==="file"?i(t):a(t.id),children:e.jsxs(me,{sx:{display:"flex",flexDirection:"column",height:"100%",alignItems:"center",p:2},children:[t.type==="file"?t.mime_type.startsWith("image/")&&t.preview_url?e.jsx(Ae,{component:"img",height:"100",image:t.preview_url,alt:t.filename,sx:{objectFit:"contain",mb:1}}):e.jsx(c,{sx:{display:"flex",justifyContent:"center",mb:1},children:f(t.mime_type)}):e.jsx(c,{sx:{display:"flex",justifyContent:"center",mb:1},children:e.jsx(R,{fontSize:"large",color:"primary"})}),e.jsxs(oe,{sx:{p:1,pt:0,width:"100%"},children:[e.jsx(u,{variant:"body2",component:"div",noWrap:!0,sx:{textAlign:"center",fontWeight:"medium",mb:.5},children:t.type==="file"?t.filename:t.name}),e.jsx(u,{variant:"caption",color:"text.secondary",sx:{display:"block",textAlign:"center"},children:x(t.date.toISOString())})]})]})})},`${t.type}-${t.id}`))})]})},Le=()=>{const{user:s}=J(),[r,i]=g.useState(null),[a,l]=g.useState(!0),[p,d]=g.useState([]),[f,x]=g.useState([]),[t,m]=g.useState(!1),n=X();g.useEffect(()=>{const o=async()=>{try{l(!0);const h=await ee.getUserStats();i(h)}catch(h){console.error("Failed to fetch user stats:",h)}finally{l(!1)}},_=async()=>{m(!0);try{const[h,G]=await Promise.all([ce.getRecentFiles(6),le.getRecentFolders(6)]);d(h),x(G)}catch(h){console.error("Error fetching recent items:",h)}finally{m(!1)}};o(),_()},[]);const y=o=>o<1?`${Math.round(o*1024)} KB`:o<1024?`${Math.round(o*10)/10} MB`:`${Math.round(o/102.4)/10} GB`,C=o=>{o.folder_id!==null?n(`/storage/${o.folder_id}`):n("/storage")},b=o=>{n(o===null?"/storage":`/storage/${o}`)},W=()=>{n("/storage")};if(a)return e.jsx(c,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh"},children:e.jsx(L,{})});const q=[{title:"Storage Used",icon:e.jsx(Y,{fontSize:"large",color:"primary"}),value:r?y(r.used_space):"0 MB",secondaryText:r?`of ${y(r.quota)}`:"of 0 MB",progress:r?r.usage_percent:0},{title:"Files",icon:e.jsx(O,{fontSize:"large",color:"primary"}),value:(r==null?void 0:r.total_files)||0,secondaryText:"total files"},{title:"Folders",icon:e.jsx(R,{fontSize:"large",color:"primary"}),value:(r==null?void 0:r.total_folders)||0,secondaryText:"total folders"}];return e.jsxs(c,{sx:{flexGrow:1},children:[e.jsxs(c,{sx:{mb:4},children:[e.jsxs(u,{variant:"h4",gutterBottom:!0,children:["Welcome",s!=null&&s.first_name?`, ${s.first_name}`:""]}),e.jsx(u,{variant:"body1",color:"textSecondary",children:"Here's an overview of your NIDrive cloud storage"})]}),e.jsx(v,{container:!0,spacing:3,sx:{mb:4},children:q.map((o,_)=>e.jsx(v,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(M,{sx:{p:3,display:"flex",flexDirection:"column",height:180,borderRadius:2},elevation:2,children:[e.jsxs(c,{sx:{display:"flex",alignItems:"center",mb:2},children:[o.icon,e.jsx(u,{variant:"h6",sx:{ml:1},children:o.title})]}),e.jsxs(c,{sx:{flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:[e.jsx(u,{variant:"h3",component:"div",sx:{fontWeight:500},children:o.value}),e.jsx(u,{variant:"body2",color:"textSecondary",children:o.secondaryText}),o.progress!==void 0&&e.jsxs(c,{sx:{mt:2},children:[e.jsx(ne,{variant:"determinate",value:o.progress,sx:{height:8,borderRadius:5,backgroundColor:h=>h.palette.grey[200],"& .MuiLinearProgress-bar":{backgroundColor:o.progress>90?"error.main":o.progress>70?"warning.main":"success.main"}}}),e.jsxs(u,{variant:"body2",color:"textSecondary",align:"right",sx:{mt:.5},children:[o.progress<.1?"less than 0.1%":`${o.progress.toFixed(1)}%`," used"]})]})]})]})},_))}),e.jsxs(M,{sx:{p:3,borderRadius:2},elevation:2,children:[e.jsx(u,{variant:"h6",gutterBottom:!0,children:"Quick Actions"}),e.jsx(Z,{sx:{mb:2}}),e.jsxs(v,{container:!0,spacing:2,children:[e.jsx(v,{item:!0,children:e.jsx(N,{variant:"contained",startIcon:e.jsx(te,{}),onClick:()=>n("/storage"),children:"Upload Files"})}),e.jsx(v,{item:!0,children:e.jsx(N,{variant:"outlined",startIcon:e.jsx(R,{}),onClick:()=>n("/storage"),children:"Browse Files"})})]})]}),e.jsx(c,{sx:{mt:4},children:e.jsx(Be,{recentFiles:p,recentFolders:f,onFileClick:C,onFolderClick:b,onViewAllClick:W,isLoading:t})})]})};export{Le as default};
