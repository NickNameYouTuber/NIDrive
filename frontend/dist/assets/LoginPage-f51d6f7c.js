import{c as h,e as x,f as y,g as f,j as t,B as n,h as c,T as i}from"./index-ed39be07.js";import{d as p}from"./Telegram-4699e9a1.js";const b=()=>{const{login:l,isAuthenticated:u,loading:g}=h(),{enqueueSnackbar:a}=x(),d=y(),o=!1,m=async e=>{try{if(await l(e)){a("Login successful",{variant:"success"});const s=localStorage.getItem("redirectAfterLogin")||"/dashboard";localStorage.removeItem("redirectAfterLogin"),d(s)}else a("Login failed. Please try again.",{variant:"error"})}catch(r){console.error("Login error:",r),a("An error occurred during login",{variant:"error"})}};return f.useEffect(()=>{window.onTelegramAuth=s=>{m(s)};const e=document.createElement("script");e.src="https://telegram.org/js/telegram-widget.js?22",e.setAttribute("data-telegram-login","nidrivebot"),e.setAttribute("data-size","large"),e.setAttribute("data-radius","8"),e.setAttribute("data-request-access","write"),e.setAttribute("data-userpic","false"),e.setAttribute("data-onauth","onTelegramAuth(user)"),e.async=!0;const r=document.getElementById("telegram-login-container");return r&&(r.innerHTML="",r.appendChild(e)),()=>{r&&(r.innerHTML=""),delete window.onTelegramAuth}},[u,o]),g?t.jsx(n,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:t.jsx(c,{})}):t.jsxs(n,{sx:{width:"100%",textAlign:"center",py:3},children:[t.jsx(p,{color:"primary",sx:{fontSize:48,mb:2}}),t.jsx(i,{variant:"h4",gutterBottom:!0,children:"Sign in with Telegram"}),t.jsx(i,{variant:"body1",color:"textSecondary",paragraph:!0,sx:{mb:4},children:"Securely access your cloud storage using your Telegram account"}),o,t.jsx(n,{id:"telegram-login-container",sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:60},children:t.jsx(c,{size:24})}),t.jsx(i,{variant:"body2",color:"textSecondary",sx:{mt:4},children:"By logging in, you agree to our Terms of Service and Privacy Policy"})]})};export{b as default};
